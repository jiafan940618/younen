<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yn.dao.mapper.ServerMapper">

<resultMap id="ServerMap" type="com.yn.model.Server">

		<id column="s_id" property="s_id" jdbcType="INTEGER" />
		<result column="company_name" property="companyName" jdbcType="VARCHAR" />
		
		  <association property="newServerPlan" javaType="com.yn.model.NewServerPlan" >
				<collection property="solarPanel" javaType="com.yn.model.SolarPanel">
					<result column="type" property="type" jdbcType="VARCHAR"/>
					<result column="conversion_efficiency" property="conversionEfficiency" jdbcType="VARCHAR"/>
					<result column="quality_assurance" property="qualityAssurance" jdbcType="VARCHAR"/>
					<result column="board_year" property="boardYear" jdbcType="VARCHAR"/>
				</collection>
		</association>
		
	</resultMap>

<sql id="server_Column_List">
		DISTINCT(s.id) s_id,s.company_name,o.type,o.conversion_efficiency,o.quality_assurance,o.board_year 
	</sql>


<select id="find" parameterType="java.lang.String" resultMap="ServerMap" >
		SELECT 
		<include refid="server_Column_List" />
		 FROM server s
 				LEFT JOIN new_server_plan p ON s.id = p.server_id
 				LEFT JOIN solar_panel o ON  p.batteryboard_id = o.id  WHERE s.del=0 
 				
 				<if test="_parameter != null">
 				  and s.server_city_text= '$(cityName)'
 				</if>
	</select>
	
	
	



</mapper>